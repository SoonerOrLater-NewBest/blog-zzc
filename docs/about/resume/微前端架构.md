对目前流行的几种前端微服务框架（qiankun、micro-app、EMP、无界）进行比较和分析，从背景、特点、不足、成本、速度、隔离、功能等多个方面展开，帮助开发者选择适合的微前端框架。

### 背景

- **前端代码复杂度增加**：前端代码库庞大（几G大小）、开发人员众多（数百人）、bundle size大（几MB），导致开发和维护成本增加。
- **需求**：需要一种能够分解复杂度、提升协作效率、支持灵活扩展的架构模式，微前端应运而生。

### 微前端框架比较

#### qiankun 方案

- **特点**：
  - 基于single-spa，通过HTML entry引入子应用，降低应用改造成本。
  - 提供完备的沙箱方案，包括JS沙箱（三套渐进增强方案）和CSS沙箱（两套方案）。
  - 支持静态资源预加载。
- **不足**：
  - 适配成本高，需要对工程化、生命周期、静态资源路径、路由等进行适配。
  - CSS沙箱严格隔离可能导致问题，JS沙箱在某些场景下性能下降。
  - 无法同时激活多个子应用，不支持子应用保活。
  - 不支持Vite等ESModule脚本运行。

#### micro-app 方案

- **特点**：
  - 基于WebComponent + qiankun沙箱，加载子应用方式更优雅。
  - 复用qiankun的沙箱机制，提供组件式API，支持子应用保活。
  - 降低子应用改造成本，支持静态资源预加载。
- **不足**：
  - 路由依赖问题依然存在。
  - 多应用激活后无法保持子应用路由状态。
  - CSS沙箱无法绝对隔离，JS沙箱性能优化有限。
  - 支持Vite运行但需改造子应用，且JS代码无法沙箱隔离。
  - 对不支持WebComponent的浏览器未做降级处理。

#### EMP 方案

- **特点**：
  - 基于Webpack 5 Module Federation，保证子应用依赖解耦。
  - 支持应用间去中心化调用和共享模块。
  - 支持远程模块的TypeScript。
- **不足**：
  - 对Webpack依赖强，老旧项目不友好。
  - 缺乏有效的CSS和JS沙箱，需要用户自行处理。
  - 不支持子应用保活和多应用激活。
  - 主、子应用路由可能冲突。

#### 无界方案

- **特点**：
  - 基于WebComponent容器 + iframe沙箱，解决适配成本、样式隔离、运行性能等问题。
  - **成本低**：
    - 主应用使用成本低，提供基于Vue和React的封装组件。
    - 子应用适配成本低，支持多种运行模式（保活、单例、重建）。
  - **速度快**：
    - 支持静态资源预加载和子应用预执行。
    - 采用Fiber执行模式，优化JS执行效率。
  - **原生隔离**：
    - CSS沙箱通过WebComponent + ShadowDOM实现。
    - JS沙箱通过iframe实现，避免性能下降。
  - **功能强大**：
    - 支持子应用保活、嵌套、多应用激活、去中心化通信。
    - 提供完善的生命周期钩子和插件系统。
    - 原生支持Vite框架，兼容IE9。
    - 支持应用共享，避免重复打包。

#### 小结

无界微前端框架采用WebComponent + iframe的方式加载子应用，具有成本低、速度快、原生隔离、功能强大等优点，使用体验类似于普通组件，极大地降低了使用门槛。

[无界文档](<[https://wujie-micro.github.io/doc/guide/](https://wujie-micro.github.io/doc/guide/)>)
