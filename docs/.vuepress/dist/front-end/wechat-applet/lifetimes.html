<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序生命周期 | 前端野路子</title>
    <meta name="description" content="Vue + Vuepress + Element-Ui + MarkDown + Axios">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b0bd6a5f.css" as="style"><link rel="preload" href="/assets/js/app.ca138bf0.js" as="script"><link rel="preload" href="/assets/js/3.2dc10a6c.js" as="script"><link rel="preload" href="/assets/js/2.f56b7d3c.js" as="script"><link rel="preload" href="/assets/js/8.c1d402e6.js" as="script"><link rel="preload" href="/assets/js/9.86c6a2be.js" as="script"><link rel="prefetch" href="/assets/js/10.4fb5d23f.js"><link rel="prefetch" href="/assets/js/100.ea32e893.js"><link rel="prefetch" href="/assets/js/101.1213a8c4.js"><link rel="prefetch" href="/assets/js/102.5e0e1d37.js"><link rel="prefetch" href="/assets/js/103.a6eccdf2.js"><link rel="prefetch" href="/assets/js/104.a11990e7.js"><link rel="prefetch" href="/assets/js/105.765506b0.js"><link rel="prefetch" href="/assets/js/106.c12f461c.js"><link rel="prefetch" href="/assets/js/107.4f0a4d30.js"><link rel="prefetch" href="/assets/js/108.b7fb388b.js"><link rel="prefetch" href="/assets/js/109.78f12f71.js"><link rel="prefetch" href="/assets/js/11.933f863b.js"><link rel="prefetch" href="/assets/js/110.e4b84986.js"><link rel="prefetch" href="/assets/js/111.c5dc8a8e.js"><link rel="prefetch" href="/assets/js/112.3c353195.js"><link rel="prefetch" href="/assets/js/113.4c6cb33e.js"><link rel="prefetch" href="/assets/js/114.3f555026.js"><link rel="prefetch" href="/assets/js/115.d07e46d8.js"><link rel="prefetch" href="/assets/js/116.515303f4.js"><link rel="prefetch" href="/assets/js/117.d98fa39c.js"><link rel="prefetch" href="/assets/js/118.b32a2b4b.js"><link rel="prefetch" href="/assets/js/119.35f9e26a.js"><link rel="prefetch" href="/assets/js/12.9c3569bf.js"><link rel="prefetch" href="/assets/js/120.e3d56bdd.js"><link rel="prefetch" href="/assets/js/121.ce6651f1.js"><link rel="prefetch" href="/assets/js/122.8d994b7f.js"><link rel="prefetch" href="/assets/js/123.dd1a2bfb.js"><link rel="prefetch" href="/assets/js/124.abc0c274.js"><link rel="prefetch" href="/assets/js/125.0464bb8f.js"><link rel="prefetch" href="/assets/js/126.91970952.js"><link rel="prefetch" href="/assets/js/127.8c3393c9.js"><link rel="prefetch" href="/assets/js/128.86280a83.js"><link rel="prefetch" href="/assets/js/129.e8566151.js"><link rel="prefetch" href="/assets/js/13.893c0c77.js"><link rel="prefetch" href="/assets/js/14.1bd2a237.js"><link rel="prefetch" href="/assets/js/15.25573d41.js"><link rel="prefetch" href="/assets/js/16.5ba9ed44.js"><link rel="prefetch" href="/assets/js/17.c80c4b2a.js"><link rel="prefetch" href="/assets/js/18.99ea6459.js"><link rel="prefetch" href="/assets/js/19.c12933aa.js"><link rel="prefetch" href="/assets/js/20.54a76890.js"><link rel="prefetch" href="/assets/js/21.0c1163f9.js"><link rel="prefetch" href="/assets/js/22.80e3f574.js"><link rel="prefetch" href="/assets/js/23.7eddd6f4.js"><link rel="prefetch" href="/assets/js/24.993fcd19.js"><link rel="prefetch" href="/assets/js/25.5bac6bcd.js"><link rel="prefetch" href="/assets/js/26.05a5919f.js"><link rel="prefetch" href="/assets/js/27.f81a4b2a.js"><link rel="prefetch" href="/assets/js/28.fcd25264.js"><link rel="prefetch" href="/assets/js/29.3fb95bb6.js"><link rel="prefetch" href="/assets/js/30.2edb1ff0.js"><link rel="prefetch" href="/assets/js/31.315d5b64.js"><link rel="prefetch" href="/assets/js/32.ccd91720.js"><link rel="prefetch" href="/assets/js/33.8a717421.js"><link rel="prefetch" href="/assets/js/34.31e76725.js"><link rel="prefetch" href="/assets/js/35.b479a06d.js"><link rel="prefetch" href="/assets/js/36.478418b0.js"><link rel="prefetch" href="/assets/js/37.6fad5d1e.js"><link rel="prefetch" href="/assets/js/38.224e84da.js"><link rel="prefetch" href="/assets/js/39.489d4ae6.js"><link rel="prefetch" href="/assets/js/4.19793402.js"><link rel="prefetch" href="/assets/js/40.f78a0b78.js"><link rel="prefetch" href="/assets/js/41.7728e103.js"><link rel="prefetch" href="/assets/js/42.6fff90eb.js"><link rel="prefetch" href="/assets/js/43.935573a5.js"><link rel="prefetch" href="/assets/js/44.f8badd7f.js"><link rel="prefetch" href="/assets/js/45.f751fadd.js"><link rel="prefetch" href="/assets/js/46.f9fcb8f6.js"><link rel="prefetch" href="/assets/js/47.478dce55.js"><link rel="prefetch" href="/assets/js/48.5816b4e1.js"><link rel="prefetch" href="/assets/js/49.7af7bc06.js"><link rel="prefetch" href="/assets/js/5.57e20511.js"><link rel="prefetch" href="/assets/js/50.dd982970.js"><link rel="prefetch" href="/assets/js/51.dc302f60.js"><link rel="prefetch" href="/assets/js/52.355c3333.js"><link rel="prefetch" href="/assets/js/53.f4d81c32.js"><link rel="prefetch" href="/assets/js/54.f806ae64.js"><link rel="prefetch" href="/assets/js/55.9fff2986.js"><link rel="prefetch" href="/assets/js/56.95d94ec3.js"><link rel="prefetch" href="/assets/js/57.88d12c4d.js"><link rel="prefetch" href="/assets/js/58.22311a5b.js"><link rel="prefetch" href="/assets/js/59.094f3c56.js"><link rel="prefetch" href="/assets/js/6.53a396b6.js"><link rel="prefetch" href="/assets/js/60.39191cb0.js"><link rel="prefetch" href="/assets/js/61.68e4dc3e.js"><link rel="prefetch" href="/assets/js/62.3611d120.js"><link rel="prefetch" href="/assets/js/63.335dfd87.js"><link rel="prefetch" href="/assets/js/64.fb3d6e98.js"><link rel="prefetch" href="/assets/js/65.4d350726.js"><link rel="prefetch" href="/assets/js/66.eb3b3542.js"><link rel="prefetch" href="/assets/js/67.ea3fa944.js"><link rel="prefetch" href="/assets/js/68.87374969.js"><link rel="prefetch" href="/assets/js/69.64abaac2.js"><link rel="prefetch" href="/assets/js/7.5f3f4aaa.js"><link rel="prefetch" href="/assets/js/70.4fa1f937.js"><link rel="prefetch" href="/assets/js/71.eefcb230.js"><link rel="prefetch" href="/assets/js/72.5b609d81.js"><link rel="prefetch" href="/assets/js/73.3db648de.js"><link rel="prefetch" href="/assets/js/74.5f13c3e8.js"><link rel="prefetch" href="/assets/js/75.e0d4fd16.js"><link rel="prefetch" href="/assets/js/76.eeb73624.js"><link rel="prefetch" href="/assets/js/77.73b2b73a.js"><link rel="prefetch" href="/assets/js/78.fbecf2d1.js"><link rel="prefetch" href="/assets/js/79.398b9683.js"><link rel="prefetch" href="/assets/js/80.f63f8554.js"><link rel="prefetch" href="/assets/js/81.ca6725a7.js"><link rel="prefetch" href="/assets/js/82.70b1cb39.js"><link rel="prefetch" href="/assets/js/83.51e35382.js"><link rel="prefetch" href="/assets/js/84.ecf96e22.js"><link rel="prefetch" href="/assets/js/85.a29b6b52.js"><link rel="prefetch" href="/assets/js/86.7d9eef0d.js"><link rel="prefetch" href="/assets/js/87.c2975d6c.js"><link rel="prefetch" href="/assets/js/88.68c740b7.js"><link rel="prefetch" href="/assets/js/89.a0192bcb.js"><link rel="prefetch" href="/assets/js/90.1c621b5e.js"><link rel="prefetch" href="/assets/js/91.661c59c0.js"><link rel="prefetch" href="/assets/js/92.9b7d20f0.js"><link rel="prefetch" href="/assets/js/93.1766758d.js"><link rel="prefetch" href="/assets/js/94.7fa3ee12.js"><link rel="prefetch" href="/assets/js/95.02f21a0a.js"><link rel="prefetch" href="/assets/js/96.98d2714e.js"><link rel="prefetch" href="/assets/js/97.045e1bed.js"><link rel="prefetch" href="/assets/js/98.5c826898.js"><link rel="prefetch" href="/assets/js/99.6c05d4fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0bd6a5f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="前端野路子" class="logo"> <span class="site-name can-hide">前端野路子</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><span><i class="el-icon-s-home"></i></span>

</a></div><div class="nav-item"><a href="/about/" class="nav-link"><!---->
关于我
</a></div><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active"><span><i class="el-icon-star-on"></i></span>
前端相关
</a></div><div class="nav-item"><a href="/service/" class="nav-link"><!---->
后端服务
</a></div><div class="nav-item"><a href="/tools/" class="nav-link"><!---->
提效工具
</a></div><div class="nav-item"><a href="/ai/" class="nav-link"><span><i class="el-icon-view"></i></span>
AIGC
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/zhouzhenchao" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/SoonerOrLater-NewBest" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><span><i class="el-icon-s-home"></i></span>

</a></div><div class="nav-item"><a href="/about/" class="nav-link"><!---->
关于我
</a></div><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active"><span><i class="el-icon-star-on"></i></span>
前端相关
</a></div><div class="nav-item"><a href="/service/" class="nav-link"><!---->
后端服务
</a></div><div class="nav-item"><a href="/tools/" class="nav-link"><!---->
提效工具
</a></div><div class="nav-item"><a href="/ai/" class="nav-link"><span><i class="el-icon-view"></i></span>
AIGC
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/zhouzhenchao" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/SoonerOrLater-NewBest" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/" class="sidebar-link">分类导航</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端工作流</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/work-flow/eslint.html" class="sidebar-link">从零构建前端 Lint 工作流</a></li><li><a href="/front-end/work-flow/git-commitizen.html" class="sidebar-link">规范 Git Commit Message</a></li><li><a href="/front-end/work-flow/tools.html" class="sidebar-link">如何选择前端构建工具？</a></li><li><a href="/front-end/work-flow/easy-mock.html" class="sidebar-link">EasyMock本地部署，随时mock数据</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/react/practice.html" class="sidebar-link">React资源整合</a></li><li><a href="/front-end/react/hooks.html" class="sidebar-link">全面拥抱React-Hooks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/javacript/ts.html" class="sidebar-link">TypeScript 概念篇</a></li><li><a href="/front-end/javacript/performance.html" class="sidebar-link">Js性能优化</a></li><li><a href="/front-end/javacript/rxjs.html" class="sidebar-link">RxJS</a></li><li><a href="/front-end/javacript/regular.html" class="sidebar-link">正则表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>微信小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/wechat-applet/lifetimes.html" class="active sidebar-link">生命周期</a></li><li><a href="/front-end/wechat-applet/data.html" class="sidebar-link">数据通信</a></li><li><a href="/front-end/wechat-applet/share.html" class="sidebar-link">转发分享</a></li><li><a href="/front-end/wechat-applet/hover-class.html" class="sidebar-link">hover-class点击态</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/css/secret.html" class="sidebar-link">CSS探索on-going</a></li><li><a href="/front-end/css/unpopular.html" class="sidebar-link">CSS小知识</a></li><li><a href="/front-end/css/css.html" class="sidebar-link">CSS编码技巧</a></li><li><a href="/front-end/css/effect.html" class="sidebar-link">CSS效果</a></li><li><a href="/front-end/css/sass.html" class="sidebar-link">Sass基础</a></li><li><a href="/front-end/css/shape.html" class="sidebar-link">45种CSS形状</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/vue/vue.html" class="sidebar-link">Vue 2.0 快速导航</a></li><li><a href="/front-end/vue/vue2-Grammer.html" class="sidebar-link">Vue 2.0 项目实战语法</a></li><li><a href="/front-end/vue/vueGrammer.html" class="sidebar-link">Vue 2.0 语法整理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Browser</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/browser/cors.html" class="sidebar-link">跨域请求</a></li><li><a href="/front-end/browser/authentication.html" class="sidebar-link">登录认证</a></li><li><a href="/front-end/browser/chrome.html" class="sidebar-link">Chrome</a></li><li><a href="/front-end/browser/http.html" class="sidebar-link">深入理解Http</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>一些常识介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/common-sense/specification.html" class="sidebar-link">前端开发规范</a></li><li><a href="/front-end/common-sense/document.html" class="sidebar-link">文档写作规范</a></li><li><a href="/front-end/common-sense/design.html" class="sidebar-link">设计修养</a></li><li><a href="/front-end/common-sense/agreement.html" class="sidebar-link">开源协议</a></li><li><a href="/front-end/common-sense/font.html" class="sidebar-link">理解一下 Font 字体</a></li></ul></section></li></ul> </aside> <aside class="sidebar sidebar-right"> <div class="advertisement" data-v-919cc31c><img src="/hero.png" alt="banner" data-v-919cc31c></div> <div class="table-of-contents" data-v-03011b6e><h4 data-v-03011b6e>目录</h4> <ul data-v-03011b6e><li data-v-03011b6e><a href="#小程序app生命周期" class="active" data-v-03011b6e>小程序App生命周期</a></li><li data-v-03011b6e><a href="#小程序page生命周期" data-v-03011b6e>小程序Page生命周期</a></li><li data-v-03011b6e><a href="#生命周期执行顺序" data-v-03011b6e>生命周期执行顺序</a></li><li data-v-03011b6e><a href="#page实例生命周期" data-v-03011b6e>Page实例生命周期</a></li><li data-v-03011b6e><a href="#总结一下" data-v-03011b6e>总结一下</a></li></ul></div> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序生命周期"><a href="#小程序生命周期" class="header-anchor">#</a> <span data-content="原创" class="blog-type-common blog-type-1" data-v-b25d40b2></span>小程序生命周期</h1> <div class="custom-block warning"><p class="custom-block-title">区分</p> <p>首先小程序的生命周期分App和Page生命周期，需要补知识的-&gt;<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="小程序app生命周期"><a href="#小程序app生命周期" class="header-anchor">#</a> 小程序App生命周期</h2> <ul><li>小程序App生命周期是在app.js里面调用的，App(Object)函数用来注册一个小程序，接受一个 Object 参数，指定其小程序的生命周期回调</li> <li>App() 必须在 app.js 中调用，必须调用且只能调用一次，不然会出现无法预期的后果</li></ul> <p><img src="/assets/img/life-01.436697cd.png" alt="'小程序App生命周期'"></p> <blockquote><p>以上应该一眼就能看明白，以下主要讲讲前台、后台定义和运行机制等</p></blockquote> <p><strong>1 . 前台、后台定义</strong></p> <ul><li>当用户点击左上角关闭，或者按了设备 Home 键离开微信，小程序并没有直接销毁，而是进入了后台onHide；当再次进入微信或再次打开小程序，又会从后台进入前台onShow。需要注意的是：只有当小程序进入后台一定时间，或者系统资源占用过高，才会被真正的销毁。</li></ul> <p><strong>2 . 运行机制</strong></p> <ul><li>小程序启动会有两种情况，一种是「冷启动」，一种是「热启动」。 假如用户已经打开过某小程序，然后在一定时间内再次打开该小程序，此时无需重新启动，只需将后台态的小程序切换到前台onShow，这个过程就是热启动；冷启动指的是用户首次打开或小程序被微信主动销毁后再次打开的情况，此时小程序需要重新加载启动onLauch</li> <li>小程序没有重启的概念</li> <li>当小程序进入后台，客户端会维持一段时间的运行状态，超过一定时间后（目前是5分钟）会被微信主动销毁</li> <li>在 iOS 上，当微信客户端在一定时间间隔内（目前是 5 秒）连续收到两次及以上系统内存告警时，会主动进行小程序的销毁，并提示用户 「该小程序可能导致微信响应变慢被终止」。建议小程序在必要时使用 wx.onMemoryWarning 监听内存告警事件，进行必要的内存清理。</li></ul> <p><strong>3 . 更新机制</strong></p> <ul><li>小程序冷启动时如果发现有新版本，将会异步下载新版本的代码包，并同时用客户端本地的包进行启动，即新版本的小程序需要等下一次冷启动才会应用上。 如果需要马上应用最新版本，可以使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/wx.getUpdateManager.html" target="_blank" rel="noopener noreferrer">wx.getUpdateManager API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 进行处理</li> <li>小程序强制更新</li></ul> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token comment">//注意，小程序的更新的api需要基础库在1.9.90以上</span>
<span class="token keyword">const</span> updateManager <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getUpdateManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
updateManager<span class="token punctuation">.</span><span class="token function">onCheckForUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求完新版本信息的回调，省略回调会报错，如下图</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>hasUpdate<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
updateManager<span class="token punctuation">.</span><span class="token function">onUpdateReady</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'更新提示'</span><span class="token punctuation">,</span>
        content<span class="token operator">:</span> <span class="token string">'新版本已经准备好，是否重启应用？'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 新的版本已经下载好，调用 applyUpdate 应用新版本并重启</span>
                updateManager<span class="token punctuation">.</span><span class="token function">applyUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
updateManager<span class="token punctuation">.</span><span class="token function">onUpdateFailed</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 新的版本下载失败</span>
    wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'更新提示'</span><span class="token punctuation">,</span>
        content<span class="token operator">:</span> <span class="token string">'新版本下载失败'</span><span class="token punctuation">,</span>
        showCancel<span class="token operator">:</span><span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><img src="/assets/img/life-02.01d14480.png" alt="'小程序App生命周期'"></p> <p><strong>3 . 再次打开逻辑</strong></p> <ul><li>用户打开小程序的预期有以下两类场景：1、打开首页 2、打开指定页面</li> <li>现在要打开的是首页，如果上一次退出的时候是首页，则保留状态；否则，清空原来的页面栈，打开首页（相当于执行 wx.reLaunch 到首页）</li> <li>现在要打开的是指定页面，不管上次在什么页面，清空原来的页面栈，打开指定页面（相当于执行 wx.reLaunch 到指定页）</li></ul> <h2 id="小程序page生命周期"><a href="#小程序page生命周期" class="header-anchor">#</a> 小程序Page生命周期</h2> <ul><li>Page(Object) 函数用来注册一个页面。接受一个 Object 类型参数，其指定页面的初始数据、生命周期回调、事件处理函数等
<img src="/assets/img/life-03.dc96657b.png" alt="'小程序Page生命周期'"></li></ul> <blockquote><p>引用一张不错的图片来让你一目了然，图片来源于网络</p></blockquote> <p><img src="/assets/img/life-04.bdadebb3.jpg" alt="'小程序生命周期'"></p> <blockquote><p>补充</p></blockquote> <h4 id="app-onpagenotfound-object"><a href="#app-onpagenotfound-object" class="header-anchor">#</a> app.onPageNotFound(Object)</h4> <blockquote><p>基础库 1.9.90 开始支持，低版本需做兼容处理。</p></blockquote> <ul><li>小程序要打开的页面不存在时触发,也可以使用 wx.onPageNotFound 绑定监听</li> <li>开发者可以在回调中进行页面重定向，但必须在回调中同步处理，异步处理（例如 setTimeout 异步执行）无效</li> <li>主要用于轮播、魔方等动态指定跳转页面的场景，避免出现页面不存在的情况</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>App({
  onPageNotFound(res) {
    // 可以封装一个小程序跳转函数，智能解决tabbar页面跳转的问题
    wx.redirectTo({
      url: 'pages/...'
    })
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="生命周期执行顺序"><a href="#生命周期执行顺序" class="header-anchor">#</a> 生命周期执行顺序</h2> <div class="custom-block warning"><p class="custom-block-title">生命周期执行顺序</p> <p>分别了解了App和Page的生命周期函数，那他们之间有何关联</p></div> <p><em>吐槽一句，好多文章说什么app的生命周期函数onLauch可能会在page的onLoad之后触发，搞得我一脸懵逼，说话这么不严谨，真的好吗？？？</em></p> <h4 id="先看看正常的生命周期"><a href="#先看看正常的生命周期" class="header-anchor">#</a> 先看看正常的生命周期</h4> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onLaunch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onShow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onHide'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onLoad'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onReady'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onShow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onHide'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onUnload'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="控制台输出"><a href="#控制台输出" class="header-anchor">#</a> 控制台输出</h4> <p><img src="data:image/png;base64,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" alt="'小程序生命周期'"></p> <h4 id="应该说永远是这个顺序，现在再加点代码，就用官方的例子"><a href="#应该说永远是这个顺序，现在再加点代码，就用官方的例子" class="header-anchor">#</a> 应该说永远是这个顺序，现在再加点代码，就用官方的例子</h4> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onLaunch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 获取用户信息</span>
    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>authSetting<span class="token punctuation">[</span><span class="token string">'scope.userInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span>
          wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token comment">// 可以将 res 发送给后台解码出 unionId</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onLaunch---success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span>
              <span class="token comment">// 所以此处加入 callback 以防止这种情况</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userInfoReadyCallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">userInfoReadyCallback</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'page---onLoad'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        userInfo<span class="token operator">:</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
        hasUserInfo<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>canIUse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span>
      <span class="token comment">// 所以此处加入 callback 以防止这种情况</span>
      app<span class="token punctuation">.</span><span class="token function-variable function">userInfoReadyCallback</span> <span class="token operator">=</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          userInfo<span class="token operator">:</span> res<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
          hasUserInfo<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 在没有 open-type=getUserInfo 版本的兼容处理</span>
      wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            userInfo<span class="token operator">:</span> res<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
            hasUserInfo<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h4 id="控制台输出-2"><a href="#控制台输出-2" class="header-anchor">#</a> 控制台输出</h4> <p><img src="/assets/img/life-06.acdc56ee.png" alt="'小程序生命周期'"></p> <ul><li><strong>可以看出小程序生命周期函数并没有错乱，只是加了异步操作</strong></li> <li><strong>你永远不知道异步操作会排在正常周期的哪一个位置</strong></li></ul> <div class="custom-block tip"><p class="custom-block-title">解决方案</p> <p>例子中已经给出了callback的方案，现在也可以使用promise来解决</p></div> <p><strong>1 . callback</strong></p> <ul><li>解释一波：Page页面判断当前app.globalData.userInfo是否有值</li> <li>如果有，说明异步操作很顺利，当做同步往下操作即可</li> <li>如果没有，则定义一个app方法（回调函数）app.userInfoReadyCallback = res =&gt; {...}</li> <li>因为Page.onLoad没有顺利拿到app.globalData.userInfo，说明App页面请求success异步操作滞后了</li> <li>此时APP页面不仅会给globalData.userInfo赋值，还会执行Page页面定义的回调方法，完成业务逻辑
<em>以上例子是官方对于授权之后的操作流程示例，实际使用替换自己的初始化函数和业务逻辑</em></li></ul> <div class="custom-block danger"><p class="custom-block-title">注意事项</p> <p>app.onLaunch全局只触发一次，也就是打开的第一个页面会有异步问题，打开第二个页面肯定是可以拿到初始化数据的，但是小程序可以从不同场景进入，可能打开的并非是首页，这时就需要给每一个可能被第一次就打开的页面，写回调函数，暂时没想到类似vue那种设置全局路由回调的方案</p></div> <p><strong>2 . promise</strong></p> <ul><li>最终效果应该和回调一样，之前小程序不支持promise，一直没有好好用过，等以后单独研究~</li></ul> <hr> <h2 id="page实例生命周期"><a href="#page实例生命周期" class="header-anchor">#</a> Page实例生命周期</h2> <div class="custom-block tip"><p class="custom-block-title">先来看一张很熟悉的图</p> <p>官方原话（以下内容你不需要立马完全弄明白，不过以后它会有帮助）</p></div> <p><img src="/assets/img/life-07.2e646c86.png" alt="'小程序生命周期'"></p> <h4 id="咋一看，什么鬼，好吧-我听你的，以后再说"><a href="#咋一看，什么鬼，好吧-我听你的，以后再说" class="header-anchor">#</a> 咋一看，什么鬼，好吧~我听你的，以后再说~</h4> <ul><li>转眼间，以后就到啦！好在有大佬解释过了，借花献佛，谁让我是搬运工呢（最后会贴上参考文章链接）</li></ul> <h4 id="page实例由两大线程组成"><a href="#page实例由两大线程组成" class="header-anchor">#</a> Page实例由两大线程组成</h4> <ul><li><p>负责界面的线程（view thread）和服务线程（appservice thread），各司其职又互相配合</p></li> <li><p>界面线程有四大状态：</p></li></ul> <ol><li><p>初始化状态：初始化界面线程所需要的工作，包括工作机制，基本和我们开发者没有关系，等初始化完毕就向 “服务线程”发送初始化完毕信号，然后进入等待传回初始化数据状态</p></li> <li><p>首次渲染状态：收到“服务线程”发来的初始化数据后（就是 json和js中的data数据），就开始渲染小程序界面，渲染完毕后，发送“首次渲染完毕信号”给服务线程，并将页面展示给用户</p></li> <li><p>持续渲染状态：此时界面线程继续一直等待“服务线程”通过this.setdata（）函数发送来的界面数据，只要收到就重新局部渲染，也因此只要更新数据并发送信号，界面就自动更新</p></li> <li><p>结束状态：你懂得</p></li></ol> <ul><li>服务线程五大状态：</li></ul> <ol><li>初始化状态：无需和其他模块交流，跟小程序开发也没多大关联，此阶段就是启动服务线程所需的基本功能，比如信号发送模块。系统的初始化工作完毕，就调用自定义的onload和onshow，
然后等待界面线程的“界面线程初始化完成”信号。
onload是只会首次渲染的时候执行一次，onshow是每次界面切换都会执行，简单理解，这就是唯一差别</li> <li>等待激活状态：接收到“界面线程初始化完成”信号后，将初始化数据发送给“界面线程”，等待界面线程完成初次渲染</li> <li>激活状态：收到界面线程发送来的“首次渲染完成”信号后，就进入激活状态既程序的正常运行状态，并调用自定义的onReady()函数。
此状态下就可以通过 this.setData 函数发送界面数据给界面线程进行局部渲染，更新页面</li> <li>后台运行状态：如果界面进入后台，服务线程就进入后台运行状态，从目前的官方解读来说，这个状态挺奇怪的，和激活状态是相同的，也可以通过setdata函数更新界面的</li></ol> <h2 id="总结一下"><a href="#总结一下" class="header-anchor">#</a> 总结一下</h2> <h4 id="小程序的一生"><a href="#小程序的一生" class="header-anchor">#</a> 小程序的一生</h4> <ul><li>打开小程序 app.onLaunch -&gt; app.onShow -&gt; Page.onLoad -&gt; Page.onShow -&gt; Page.onReady 进入下一个页面 -&gt; Page.onHide -&gt; Next.onLoad -&gt; Next.onShow -&gt; Next.onReady 返回上一个页面 -&gt; Next.onUnload -&gt; Page.onShow 离开小程序 -&gt; app.onHide 再次进入 -&gt; app未销毁 -&gt;app.onShow 否则从头开始（销毁判断看上文运行机制）</li></ul> <h4 id="只触发一次的，一般都是用来初始化操作"><a href="#只触发一次的，一般都是用来初始化操作" class="header-anchor">#</a> 只触发一次的，一般都是用来初始化操作</h4> <ul><li>onLaunch：初始化全局数据，注意异步问题</li> <li>onLoad：初始化页面数据</li> <li>onReady：代表页面已经准备妥当，界面内容的修改，最好放在这里，如wx.setNavigationBarTitle</li> <li>onUnload：不怎么用，都销毁了，该去领盒饭了吧大概</li></ul> <h4 id="触发多次的，一般用来改变状态"><a href="#触发多次的，一般用来改变状态" class="header-anchor">#</a> 触发多次的，一般用来改变状态</h4> <ul><li>onShow：刷新</li> <li>onHide：重置</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/1/2024, 4:22:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end/javacript/regular.html" class="prev">
        正则表达式
      </a></span> <span class="next"><a href="/front-end/wechat-applet/data.html">
        数据通信
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ca138bf0.js" defer></script><script src="/assets/js/3.2dc10a6c.js" defer></script><script src="/assets/js/2.f56b7d3c.js" defer></script><script src="/assets/js/8.c1d402e6.js" defer></script><script src="/assets/js/9.86c6a2be.js" defer></script>
  </body>
</html>
