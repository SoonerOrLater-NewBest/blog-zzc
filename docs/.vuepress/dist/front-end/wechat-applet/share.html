<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序转发 | 前端野路子</title>
    <meta name="description" content="Vue + Vuepress + Element-Ui + MarkDown + Axios">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/logo.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.b0bd6a5f.css" as="style"><link rel="preload" href="/assets/js/app.ca138bf0.js" as="script"><link rel="preload" href="/assets/js/3.2dc10a6c.js" as="script"><link rel="preload" href="/assets/js/2.f56b7d3c.js" as="script"><link rel="preload" href="/assets/js/10.4fb5d23f.js" as="script"><link rel="preload" href="/assets/js/9.86c6a2be.js" as="script"><link rel="prefetch" href="/assets/js/100.ea32e893.js"><link rel="prefetch" href="/assets/js/101.1213a8c4.js"><link rel="prefetch" href="/assets/js/102.5e0e1d37.js"><link rel="prefetch" href="/assets/js/103.a6eccdf2.js"><link rel="prefetch" href="/assets/js/104.a11990e7.js"><link rel="prefetch" href="/assets/js/105.765506b0.js"><link rel="prefetch" href="/assets/js/106.c12f461c.js"><link rel="prefetch" href="/assets/js/107.4f0a4d30.js"><link rel="prefetch" href="/assets/js/108.b7fb388b.js"><link rel="prefetch" href="/assets/js/109.78f12f71.js"><link rel="prefetch" href="/assets/js/11.933f863b.js"><link rel="prefetch" href="/assets/js/110.e4b84986.js"><link rel="prefetch" href="/assets/js/111.c5dc8a8e.js"><link rel="prefetch" href="/assets/js/112.3c353195.js"><link rel="prefetch" href="/assets/js/113.4c6cb33e.js"><link rel="prefetch" href="/assets/js/114.3f555026.js"><link rel="prefetch" href="/assets/js/115.d07e46d8.js"><link rel="prefetch" href="/assets/js/116.515303f4.js"><link rel="prefetch" href="/assets/js/117.d98fa39c.js"><link rel="prefetch" href="/assets/js/118.b32a2b4b.js"><link rel="prefetch" href="/assets/js/119.35f9e26a.js"><link rel="prefetch" href="/assets/js/12.9c3569bf.js"><link rel="prefetch" href="/assets/js/120.e3d56bdd.js"><link rel="prefetch" href="/assets/js/121.ce6651f1.js"><link rel="prefetch" href="/assets/js/122.8d994b7f.js"><link rel="prefetch" href="/assets/js/123.dd1a2bfb.js"><link rel="prefetch" href="/assets/js/124.abc0c274.js"><link rel="prefetch" href="/assets/js/125.0464bb8f.js"><link rel="prefetch" href="/assets/js/126.91970952.js"><link rel="prefetch" href="/assets/js/127.8c3393c9.js"><link rel="prefetch" href="/assets/js/128.86280a83.js"><link rel="prefetch" href="/assets/js/129.e8566151.js"><link rel="prefetch" href="/assets/js/13.893c0c77.js"><link rel="prefetch" href="/assets/js/14.1bd2a237.js"><link rel="prefetch" href="/assets/js/15.25573d41.js"><link rel="prefetch" href="/assets/js/16.5ba9ed44.js"><link rel="prefetch" href="/assets/js/17.c80c4b2a.js"><link rel="prefetch" href="/assets/js/18.99ea6459.js"><link rel="prefetch" href="/assets/js/19.c12933aa.js"><link rel="prefetch" href="/assets/js/20.54a76890.js"><link rel="prefetch" href="/assets/js/21.0c1163f9.js"><link rel="prefetch" href="/assets/js/22.80e3f574.js"><link rel="prefetch" href="/assets/js/23.7eddd6f4.js"><link rel="prefetch" href="/assets/js/24.993fcd19.js"><link rel="prefetch" href="/assets/js/25.5bac6bcd.js"><link rel="prefetch" href="/assets/js/26.05a5919f.js"><link rel="prefetch" href="/assets/js/27.f81a4b2a.js"><link rel="prefetch" href="/assets/js/28.fcd25264.js"><link rel="prefetch" href="/assets/js/29.3fb95bb6.js"><link rel="prefetch" href="/assets/js/30.2edb1ff0.js"><link rel="prefetch" href="/assets/js/31.315d5b64.js"><link rel="prefetch" href="/assets/js/32.ccd91720.js"><link rel="prefetch" href="/assets/js/33.8a717421.js"><link rel="prefetch" href="/assets/js/34.31e76725.js"><link rel="prefetch" href="/assets/js/35.b479a06d.js"><link rel="prefetch" href="/assets/js/36.478418b0.js"><link rel="prefetch" href="/assets/js/37.6fad5d1e.js"><link rel="prefetch" href="/assets/js/38.224e84da.js"><link rel="prefetch" href="/assets/js/39.489d4ae6.js"><link rel="prefetch" href="/assets/js/4.19793402.js"><link rel="prefetch" href="/assets/js/40.f78a0b78.js"><link rel="prefetch" href="/assets/js/41.7728e103.js"><link rel="prefetch" href="/assets/js/42.6fff90eb.js"><link rel="prefetch" href="/assets/js/43.935573a5.js"><link rel="prefetch" href="/assets/js/44.f8badd7f.js"><link rel="prefetch" href="/assets/js/45.f751fadd.js"><link rel="prefetch" href="/assets/js/46.f9fcb8f6.js"><link rel="prefetch" href="/assets/js/47.478dce55.js"><link rel="prefetch" href="/assets/js/48.5816b4e1.js"><link rel="prefetch" href="/assets/js/49.7af7bc06.js"><link rel="prefetch" href="/assets/js/5.57e20511.js"><link rel="prefetch" href="/assets/js/50.dd982970.js"><link rel="prefetch" href="/assets/js/51.dc302f60.js"><link rel="prefetch" href="/assets/js/52.355c3333.js"><link rel="prefetch" href="/assets/js/53.f4d81c32.js"><link rel="prefetch" href="/assets/js/54.f806ae64.js"><link rel="prefetch" href="/assets/js/55.9fff2986.js"><link rel="prefetch" href="/assets/js/56.95d94ec3.js"><link rel="prefetch" href="/assets/js/57.88d12c4d.js"><link rel="prefetch" href="/assets/js/58.22311a5b.js"><link rel="prefetch" href="/assets/js/59.094f3c56.js"><link rel="prefetch" href="/assets/js/6.53a396b6.js"><link rel="prefetch" href="/assets/js/60.39191cb0.js"><link rel="prefetch" href="/assets/js/61.68e4dc3e.js"><link rel="prefetch" href="/assets/js/62.3611d120.js"><link rel="prefetch" href="/assets/js/63.335dfd87.js"><link rel="prefetch" href="/assets/js/64.fb3d6e98.js"><link rel="prefetch" href="/assets/js/65.4d350726.js"><link rel="prefetch" href="/assets/js/66.eb3b3542.js"><link rel="prefetch" href="/assets/js/67.ea3fa944.js"><link rel="prefetch" href="/assets/js/68.87374969.js"><link rel="prefetch" href="/assets/js/69.64abaac2.js"><link rel="prefetch" href="/assets/js/7.5f3f4aaa.js"><link rel="prefetch" href="/assets/js/70.4fa1f937.js"><link rel="prefetch" href="/assets/js/71.eefcb230.js"><link rel="prefetch" href="/assets/js/72.5b609d81.js"><link rel="prefetch" href="/assets/js/73.3db648de.js"><link rel="prefetch" href="/assets/js/74.5f13c3e8.js"><link rel="prefetch" href="/assets/js/75.e0d4fd16.js"><link rel="prefetch" href="/assets/js/76.eeb73624.js"><link rel="prefetch" href="/assets/js/77.73b2b73a.js"><link rel="prefetch" href="/assets/js/78.fbecf2d1.js"><link rel="prefetch" href="/assets/js/79.398b9683.js"><link rel="prefetch" href="/assets/js/8.c1d402e6.js"><link rel="prefetch" href="/assets/js/80.f63f8554.js"><link rel="prefetch" href="/assets/js/81.ca6725a7.js"><link rel="prefetch" href="/assets/js/82.70b1cb39.js"><link rel="prefetch" href="/assets/js/83.51e35382.js"><link rel="prefetch" href="/assets/js/84.ecf96e22.js"><link rel="prefetch" href="/assets/js/85.a29b6b52.js"><link rel="prefetch" href="/assets/js/86.7d9eef0d.js"><link rel="prefetch" href="/assets/js/87.c2975d6c.js"><link rel="prefetch" href="/assets/js/88.68c740b7.js"><link rel="prefetch" href="/assets/js/89.a0192bcb.js"><link rel="prefetch" href="/assets/js/90.1c621b5e.js"><link rel="prefetch" href="/assets/js/91.661c59c0.js"><link rel="prefetch" href="/assets/js/92.9b7d20f0.js"><link rel="prefetch" href="/assets/js/93.1766758d.js"><link rel="prefetch" href="/assets/js/94.7fa3ee12.js"><link rel="prefetch" href="/assets/js/95.02f21a0a.js"><link rel="prefetch" href="/assets/js/96.98d2714e.js"><link rel="prefetch" href="/assets/js/97.045e1bed.js"><link rel="prefetch" href="/assets/js/98.5c826898.js"><link rel="prefetch" href="/assets/js/99.6c05d4fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0bd6a5f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="前端野路子" class="logo"> <span class="site-name can-hide">前端野路子</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><span><i class="el-icon-s-home"></i></span>

</a></div><div class="nav-item"><a href="/about/" class="nav-link"><!---->
关于我
</a></div><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active"><span><i class="el-icon-star-on"></i></span>
前端相关
</a></div><div class="nav-item"><a href="/service/" class="nav-link"><!---->
后端服务
</a></div><div class="nav-item"><a href="/tools/" class="nav-link"><!---->
提效工具
</a></div><div class="nav-item"><a href="/ai/" class="nav-link"><span><i class="el-icon-view"></i></span>
AIGC
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/zhouzhenchao" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/SoonerOrLater-NewBest" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><span><i class="el-icon-s-home"></i></span>

</a></div><div class="nav-item"><a href="/about/" class="nav-link"><!---->
关于我
</a></div><div class="nav-item"><a href="/front-end/" class="nav-link router-link-active"><span><i class="el-icon-star-on"></i></span>
前端相关
</a></div><div class="nav-item"><a href="/service/" class="nav-link"><!---->
后端服务
</a></div><div class="nav-item"><a href="/tools/" class="nav-link"><!---->
提效工具
</a></div><div class="nav-item"><a href="/ai/" class="nav-link"><span><i class="el-icon-view"></i></span>
AIGC
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://segmentfault.com/u/zhouzhenchao" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/SoonerOrLater-NewBest" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/" class="sidebar-link">分类导航</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端工作流</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/work-flow/eslint.html" class="sidebar-link">从零构建前端 Lint 工作流</a></li><li><a href="/front-end/work-flow/git-commitizen.html" class="sidebar-link">规范 Git Commit Message</a></li><li><a href="/front-end/work-flow/tools.html" class="sidebar-link">如何选择前端构建工具？</a></li><li><a href="/front-end/work-flow/easy-mock.html" class="sidebar-link">EasyMock本地部署，随时mock数据</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/react/practice.html" class="sidebar-link">React资源整合</a></li><li><a href="/front-end/react/hooks.html" class="sidebar-link">全面拥抱React-Hooks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/javacript/ts.html" class="sidebar-link">TypeScript 概念篇</a></li><li><a href="/front-end/javacript/performance.html" class="sidebar-link">Js性能优化</a></li><li><a href="/front-end/javacript/rxjs.html" class="sidebar-link">RxJS</a></li><li><a href="/front-end/javacript/regular.html" class="sidebar-link">正则表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>微信小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/wechat-applet/lifetimes.html" class="sidebar-link">生命周期</a></li><li><a href="/front-end/wechat-applet/data.html" class="sidebar-link">数据通信</a></li><li><a href="/front-end/wechat-applet/share.html" class="active sidebar-link">转发分享</a></li><li><a href="/front-end/wechat-applet/hover-class.html" class="sidebar-link">hover-class点击态</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/css/secret.html" class="sidebar-link">CSS探索on-going</a></li><li><a href="/front-end/css/unpopular.html" class="sidebar-link">CSS小知识</a></li><li><a href="/front-end/css/css.html" class="sidebar-link">CSS编码技巧</a></li><li><a href="/front-end/css/effect.html" class="sidebar-link">CSS效果</a></li><li><a href="/front-end/css/sass.html" class="sidebar-link">Sass基础</a></li><li><a href="/front-end/css/shape.html" class="sidebar-link">45种CSS形状</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/vue/vue.html" class="sidebar-link">Vue 2.0 快速导航</a></li><li><a href="/front-end/vue/vue2-Grammer.html" class="sidebar-link">Vue 2.0 项目实战语法</a></li><li><a href="/front-end/vue/vueGrammer.html" class="sidebar-link">Vue 2.0 语法整理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Browser</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/browser/cors.html" class="sidebar-link">跨域请求</a></li><li><a href="/front-end/browser/authentication.html" class="sidebar-link">登录认证</a></li><li><a href="/front-end/browser/chrome.html" class="sidebar-link">Chrome</a></li><li><a href="/front-end/browser/http.html" class="sidebar-link">深入理解Http</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>一些常识介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front-end/common-sense/specification.html" class="sidebar-link">前端开发规范</a></li><li><a href="/front-end/common-sense/document.html" class="sidebar-link">文档写作规范</a></li><li><a href="/front-end/common-sense/design.html" class="sidebar-link">设计修养</a></li><li><a href="/front-end/common-sense/agreement.html" class="sidebar-link">开源协议</a></li><li><a href="/front-end/common-sense/font.html" class="sidebar-link">理解一下 Font 字体</a></li></ul></section></li></ul> </aside> <aside class="sidebar sidebar-right"> <div class="advertisement" data-v-919cc31c><img src="/hero.png" alt="banner" data-v-919cc31c></div> <div class="table-of-contents" data-v-03011b6e><h4 data-v-03011b6e>目录</h4> <ul data-v-03011b6e><li style="padding-left:1em;" data-v-03011b6e><a href="#转发的意义" class="active" data-v-03011b6e>转发的意义</a></li><li style="padding-left:1em;" data-v-03011b6e><a href="#官方转发示例" data-v-03011b6e>官方转发示例</a></li><li style="padding-left:1em;" data-v-03011b6e><a href="#根据场景值区分" data-v-03011b6e>根据场景值区分</a></li><li style="padding-left:1em;" data-v-03011b6e><a href="#小程序分享票据-sharetickets" data-v-03011b6e>小程序分享票据 shareTickets</a></li><li style="padding-left:1em;" data-v-03011b6e><a href="#转发动态消息" data-v-03011b6e>转发动态消息</a></li><li style="padding-left:1em;" data-v-03011b6e><a href="#总结" data-v-03011b6e>总结</a></li></ul></div> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序转发"><a href="#小程序转发" class="header-anchor">#</a> <span data-content="原创" class="blog-type-common blog-type-1" data-v-b25d40b2></span>小程序转发</h1> <h3 id="转发的意义"><a href="#转发的意义" class="header-anchor">#</a> 转发的意义</h3> <ul><li>转发即是分享，分享带动了事物去中心化，实现网络化，最终走向云处理化</li> <li>通过微信平台，转发即是聊天</li> <li>流量时代，转发即是引流</li></ul> <h3 id="官方转发示例"><a href="#官方转发示例" class="header-anchor">#</a> 官方转发示例</h3> <p><strong>onShareAppMessage(Object)</strong></p> <ul><li><p>监听用户点击页面内转发按钮（<code>&lt;button&gt;</code> 组件 open-type=&quot;share&quot;）或右上角菜单“转发”按钮的行为，并自定义转发内容。</p></li> <li><p>注意：只有定义了此事件处理函数，右上角菜单才会显示“转发”按钮</p></li></ul> <p><strong>Object 参数说明：</strong> <img src="/assets/img/share1.c906e93e.png" alt="clipboard.png"></p> <p>此事件需要 return 一个 Object，用于自定义转发内容，返回内容如下：</p> <p><strong>自定义转发内容</strong></p> <p><img src="/assets/img/share2.9ced7203.png" alt="clipboard.png"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onShareAppMessage</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token string">'button'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 来自页面内转发按钮</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">'自定义转发标题'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">'/page/user?id=123'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>常规转发，只需上面示例即可</strong></p> <ul><li>在 onShareAppMessage 中定义转发内容和必要参数，如?id=123</li> <li>在相应页面的 onLoad(Object query)中可以获取</li></ul> <h3 id="根据场景值区分"><a href="#根据场景值区分" class="header-anchor">#</a> 根据场景值区分</h3> <ul><li>对于小程序，可以在 App 的 onLaunch 和 onShow，或 wx.getLaunchOptionsSync 中获取<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/scene.html" target="_blank" rel="noopener noreferrer">场景值<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>由于 onLaunch 全局只触发一次和热启动的原因，在 onShow 中获取、设置相关参数比较合理，尤其是转发，从微信消息过来，必然会触发 onShow</li> <li>通过 app.onShow 回调，获取场景值</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app---onShow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1044是群聊，1007是私聊</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>wx.onAppShow(function callback)</strong></p> <p>基础库 2.1.2 开始支持，低版本需做兼容处理
监听小程序切前台事件。该事件与 App.onShow 的回调参数一致</p> <p><strong>Object res</strong></p> <p><img src="/assets/img/share3.f074c9fd.png" alt="clipboard.png"></p> <p><strong>referrerInfo 的结构</strong></p> <p><img src="data:image/png;base64,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" alt="clipboard.png"></p> <p>返回有效 referrerInfo 的场景</p> <p><img src="/assets/img/share5.d9921c77.png" alt="clipboard.png"></p> <blockquote><p>注意
部分版本在无 referrerInfo 的时候会返回 undefined，建议使用 options.referrerInfo &amp;&amp; options.referrerInfo.appId 进行判断</p></blockquote> <h3 id="小程序分享票据-sharetickets"><a href="#小程序分享票据-sharetickets" class="header-anchor">#</a> 小程序分享票据 shareTickets</h3> <p>通常开发者希望转发出去的小程序被二次打开的时候能够获取到一些信息，例如群的标识。现在通过调用 wx.showShareMenu 并且设置 withShareTicket 为 true ，当用户将小程序转发到任一群聊之后，此转发卡片在群聊中被其他用户打开时，可以在 App.onLaunch 或 App.onShow 获取到一个 shareTicket。通过调用 wx.getShareInfo() 接口传入此 shareTicket 可以获取到转发信息。</p> <ul><li>和场景值 scene 一样，shareTicket 也是在 App.onShow 中获取比较合理</li> <li><strong>必须在分享前调用 wx.showShareMenu 方法，否则不会带分享票据</strong></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>//分享前share.js
Page({
  onLoad: function () {
    wx.showShareMenu({
      withShareTicket: true
    })
  }
})
//分享后app.js
App({
  onShow(res) {
    console.log('app---onShow');
    console.log(res.shareTicket);
  }
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>只有分享到任一群聊，shareTicket 才会有值，否则是 undefined</li> <li>shareTicket 也可以用来区分转发消息的场景</li> <li>shareTicket 主要用来获取转发详情，传入 wx.getShareInfo()中获取加密数据，需要后端配合，返回解密数据
<blockquote><p>注意：注意：注意
鉴于官方“分享监听”能力调整，网上 90%的滞后代码，误人子弟（吐槽一下度娘已死，没人打我吧？打我就删除）</p></blockquote></li></ul> <p>类似如下代码，现在已不支持回调</p> <p><img src="/assets/img/share6.2f917571.png" alt="clipboard.png"></p> <p><strong>此次调整可能影响到三种分享功能的用法</strong></p> <ul><li><p>第一种:判断用户是否分享成功，进而给予用户奖励。</p> <p>例如：小程序提示用户“分享到 5 个群，可以获得一张 20 元的优惠券”。</p> <p>这类诱导用户分享的行为是我们平台所不倡导的，后续将没有办法实现。</p></li> <li><p>第二种:分享完成后变更当前的页面状态</p> <p>例如：赠送礼品场景下，用户点击“赠送”按钮，将礼品分享出去，分享成功后，界面展示“等待领取”。</p> <p>这类场景，我们建议可以适当调整交互方案。例如在分享后继续保留“赠送”按钮，但在页面上提示用户一个礼品只能被一人领取，重复赠送无效。</p></li> <li><p>第三种：通过用户分享之后的 shareTicket 获取群唯一标识 openGId ，以显示对应群的相关信息。</p> <p>例如：通过分享小程序到某个群里，可以查看该群内成员的排行榜。</p></li></ul> <p>此次调整后，用户分享完成后无法立刻显示该群的排行榜信息，但仍可在用户从群消息点击进入小程序时显示该群的排行榜信息。</p> <ul><li>详情请查看 <a href="https://developers.weixin.qq.com/community/develop/doc/0000447a5b431807af57249a551408" target="_blank" rel="noopener noreferrer">分享监听能力调整<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="转发动态消息"><a href="#转发动态消息" class="header-anchor">#</a> 转发动态消息</h3> <p>从基础库 2.4.0 开始，支持转发动态消息。动态消息对比普通消息，有以下特点：</p> <ul><li>消息发出去之后，开发者可以通过后台接口修改部分消息内容</li> <li>消息有对应的提醒按钮，用户点击提醒按钮可以订阅提醒，开发者可以通过后台修改消息状态并推送一次提醒消息给订阅了提醒的用户</li></ul> <p><strong>简要步骤如下</strong></p> <ol><li>（后端调用）每条动态消息可以理解为一个活动，活动发起前需要通过 createActivityId 接口创建 activity_id 后续转发动态消息以及更新动态消息都需要传入这个 activity_id</li> <li>通过调用 wx.updateShareMenu 接口，传入 isUpdatableMessage: true 等参数</li> <li>（后端调用）动态消息发出去之后，可以通过 setUpdatableMsg 修改消息内容</li></ol> <p><strong>像拼团这样的活动，可以考虑优化成动态消息，需要后端配合，实战的时再补充</strong></p> <h3 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h3> <ul><li>分享监听能力调整后，对于分享的骚操作基本在 App.onShow 中进行，相当于授权那样，必须打开转发消息才能获取转发详情，这也是符合设计准则的</li> <li>可以看出，不管是从设计准则，还是用户隐私，微信都在向着 IOS 看齐，黑暗法则已过去，我们也该注重规范和隐私了</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/1/2024, 4:22:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front-end/wechat-applet/data.html" class="prev">
        数据通信
      </a></span> <span class="next"><a href="/front-end/wechat-applet/hover-class.html">
        hover-class点击态
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ca138bf0.js" defer></script><script src="/assets/js/3.2dc10a6c.js" defer></script><script src="/assets/js/2.f56b7d3c.js" defer></script><script src="/assets/js/10.4fb5d23f.js" defer></script><script src="/assets/js/9.86c6a2be.js" defer></script>
  </body>
</html>
